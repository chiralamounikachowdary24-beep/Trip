<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WorldVista Login</title>
  <link rel="stylesheet" href="css/style.css">

  <!-- Google Identity Script -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>

<body class="login-body">

  <div class="login-container">
    <h1>Welcome to WorldVista</h1>
    <p class="subtitle">Sign in to continue</p>

    <!-- GOOGLE SIGN IN -->
    <div id="g_id_onload"
         data-client_id="555813603982-58u29nvm3gu0fek74hqlmgkts8d0dahq.apps.googleusercontent.com"
         data-callback="handleCredentialResponse">
    </div>

    <div class="g_id_signin"
         data-type="standard"
         data-size="large"
         data-theme="outline"
         data-text="continue_with"
         data-shape="rectangular">
    </div>

    <div class="divider">
      <span>OR</span>
    </div>

    <!-- EMAIL LOGIN -->
    <form onsubmit="login(event)">

      <label>Login As</label>
      <select id="loginRole" required>
        <option value="user">User</option>
        <option value="admin">Admin</option>
      </select>

      <label>Email</label>
      <input type="email" id="email" placeholder="you@example.com" required>

      <label>Password</label>
      <input type="password" id="password" placeholder="Minimum 8 characters" minlength="8" required>

      <button type="submit" class="signin-btn">Sign in</button>

    </form>

    <div class="links">
      <span>Forgot password?</span>
      <span>Need an account? <b>Sign up</b></span>
    </div>
  </div>

  <!-- GOOGLE LOGIN CALLBACK -->
  <script>
    function handleCredentialResponse(response) {

      // Save session data
      sessionStorage.setItem("role", "user");
      sessionStorage.setItem("userEmail", "googleuser@gmail.com");

      // Redirect to previous page
      let redirectPage = sessionStorage.getItem("redirectPage");

      if (redirectPage) {
        window.location.href = redirectPage;
      } else {
        window.location.href = "home.html";
      }
    }
  </script>

  <script src="js/auth.js"></script>
</body>
</html>
